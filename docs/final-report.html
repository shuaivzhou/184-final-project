<!DOCTYPE html> 
<html lang="en-US" xml:lang="en-US" > 
<head><title>2D Smoke Simulation with Game Effects: Final Report</title> 
<meta  charset="utf-8" /> 
<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<meta name="viewport" content="width=device-width,initial-scale=1" /> 
<link rel="stylesheet" type="text/css" href="main.css" /> 
<meta name="src" content="main.tex" /> 
</head><body 
>
<div class="maketitle">
                                                                                         
                                                                                         
                                                                                         
                                                                                         

<h2 class="titleHead">2D Smoke Simulation with Game Effects: Final Report<br /></h2>
 <div class="author" ><span 
class="ptmr7t-x-x-144">Kane, Jade: jademariekane@berkeley.edu</span><br /><br />
<br />  <span 
class="ptmr7t-x-x-144">Kim, Minjune: mkim123@berkeley.edu</span><br /><br />
<br />  <span 
class="ptmr7t-x-x-144">Tran, Danny: dannyltran@berkeley.edu</span><br /><br />
<br />  <span 
class="ptmr7t-x-x-144">Zhou, Victor: shuaivzhou@berkeley.edu</span></div><br />
<div class="date" > <span 
class="ptmr7t-x-x-144">May 1, 2023</span><br />
<span 
class="ptmr7t-x-x-144"><a href="https://shuaivzhou.github.io/184-final-project/final-report.html" target="_self" rel="noopener noreferrer">Final Writeup Website Link</a></span></div>
</div><!--l. 102--><p class="noindent" >


  <ul>
    <li><a href="index.html" target="_self" rel="noopener noreferrer">Home</a></li>
    <li><a href="proj-proposal.html" target="_self" rel="noopener noreferrer">Project Proposal</a></li>
    <li><a href="milestone-report.html" target="_self" rel="noopener noreferrer">Milestone Report</a></li>
    <li><a href="final-report.html" target="_self" rel="noopener noreferrer">Final Report</a></li>
    <li><a href="src/index.html" target="_blank" rel="noopener noreferrer">Demo</a></li>
  </ul>

  <tr align="center">
    <td>
      <video width="320" height="240" controls>
        <source src="images/2D_Smoke_Simulation_With_Game_Effects.mp4" type="video/mp4">
      </video>
      <figcaption>Presentation Video</figcaption>
    </td>
    </tr>

    <ul>
      <li><a href="CS184_Final_Project.pdf" target="_blank" rel="noopener noreferrer">Final Paper</a></li>
    </ul>
                                                                                         
                                                                                         
</p>
<h3 class="likesectionHead"><a 
 id="x1-1000"></a>Contents</h3>
<div class="tableofcontents">
 <span class="sectionToc" >1 <a 
href="#x1-20001" id="QQ2-1-2">Abstract</a></span>
<br /> <span class="sectionToc" >2 <a 
href="#x1-30002" id="QQ2-1-3">Technical Approach</a></span>
<br />  <span class="subsectionToc" >2.1 <a 
href="#x1-40002.1" id="QQ2-1-6">Vorticity Confinement</a></span>
<br />   <span class="subsubsectionToc" >2.1.1 <a 
href="#x1-50002.1.1" id="QQ2-1-7">Relation to Navier-Stokes</a></span>
<br />   <span class="subsubsectionToc" >2.1.2 <a 
href="#x1-60002.1.2" id="QQ2-1-8">Helper Functions</a></span>
<br />   <span class="subsubsectionToc" >2.1.3 <a 
href="#x1-70002.1.3" id="QQ2-1-9">Implementation of Steinhoff’s Vorticity Confinement</a></span>
<br />   <span class="subsubsectionToc" >2.1.4 <a 
href="#x1-80002.1.4" id="QQ2-1-10">Converting Vorticity Confinement to Velocity</a></span>
<br />   <span class="subsubsectionToc" >2.1.5 <a 
href="#x1-90002.1.5" id="QQ2-1-11">Struggles and Resolutions</a></span>
<br />  <span class="subsectionToc" >2.2 <a 
href="#x1-100002.2" id="QQ2-1-12">Heat and Buoyancy</a></span>
<br />   <span class="subsubsectionToc" >2.2.1 <a 
href="#x1-110002.2.1" id="QQ2-1-13">Spread of Heat</a></span>
<br />   <span class="subsubsectionToc" >2.2.2 <a 
href="#x1-120002.2.2" id="QQ2-1-14">Buoyancy</a></span>
<br />   <span class="subsubsectionToc" >2.2.3 <a 
href="#x1-130002.2.3" id="QQ2-1-15">Practicalities of Adding Heat</a></span>
<br />   <span class="subsubsectionToc" >2.2.4 <a 
href="#x1-140002.2.4" id="QQ2-1-16">If We Could Expand</a></span>
<br />  <span class="subsectionToc" >2.3 <a 
href="#x1-150002.3" id="QQ2-1-17">Game Effects</a></span>
<br />   <span class="subsubsectionToc" >2.3.1 <a 
href="#x1-160002.3.1" id="QQ2-1-18">Smoke Grenade</a></span>
<br />   <span class="subsubsectionToc" >2.3.2 <a 
href="#x1-170002.3.2" id="QQ2-1-20">Flare Grenade</a></span>
<br />   <span class="subsubsectionToc" >2.3.3 <a 
href="#x1-180002.3.3" id="QQ2-1-22">Boom Beach Background</a></span>
<br />  <span class="subsectionToc" >2.4 <a 
href="#x1-190002.4" id="QQ2-1-23">Shaders</a></span>
<br />   <span class="subsubsectionToc" >2.4.1 <a 
href="#x1-200002.4.1" id="QQ2-1-24">Smoke Color Shader</a></span>
<br />   <span class="subsubsectionToc" >2.4.2 <a 
href="#x1-210002.4.2" id="QQ2-1-25">Blocky Shader</a></span>
<br />   <span class="subsubsectionToc" >2.4.3 <a 
href="#x1-220002.4.3" id="QQ2-1-26">Van Gogh Inspired Shader</a></span>
<br />   <span class="subsubsectionToc" >2.4.4 <a 
href="#x1-230002.4.4" id="QQ2-1-28">Phong Model Inspired Shader</a></span>
<br />   <span class="subsubsectionToc" >2.4.5 <a 
href="#x1-270002.4.5" id="QQ2-1-32">Heat Shader</a></span>
<br /> <span class="sectionToc" >3 <a 
href="#x1-280003" id="QQ2-1-33">Results</a></span>
<br />  <span class="subsectionToc" >3.1 <a 
href="#x1-290003.1" id="QQ2-1-34">Vorticity</a></span>
<br />  <span class="subsectionToc" >3.2 <a 
href="#x1-300003.2" id="QQ2-1-41">Heat and Buoyancy</a></span>
<br />  <span class="subsectionToc" >3.3 <a 
href="#x1-310003.3" id="QQ2-1-46">Game Effects</a></span>
<br />  <span class="subsectionToc" >3.4 <a 
href="#x1-320003.4" id="QQ2-1-56">Shaders</a></span>
<br />   <span class="subsubsectionToc" >3.4.1 <a 
href="#x1-330003.4.1" id="QQ2-1-57">Color Shader</a></span>
<br />   <span class="subsubsectionToc" >3.4.2 <a 
href="#x1-340003.4.2" id="QQ2-1-60">Blocky Shader</a></span>
<br />   <span class="subsubsectionToc" >3.4.3 <a 
href="#x1-350003.4.3" id="QQ2-1-63">Van Gogh Inspired Shader</a></span>
<br />   <span class="subsubsectionToc" >3.4.4 <a 
href="#x1-360003.4.4" id="QQ2-1-66">Phong Model Inspired Shader</a></span>
<br />   <span class="subsubsectionToc" >3.4.5 <a 
href="#x1-370003.4.5" id="QQ2-1-69">Heat Shader</a></span>
<br /> <span class="sectionToc" >4 <a 
href="#x1-380004" id="QQ2-1-71">Contributions</a></span>
<br />  <span class="subsectionToc" >4.1 <a 
href="#x1-390004.1" id="QQ2-1-72">Jade Kane</a></span>
<br />  <span class="subsectionToc" >4.2 <a 
href="#x1-400004.2" id="QQ2-1-73">Minjune Kim</a></span>
<br />  <span class="subsectionToc" >4.3 <a 
href="#x1-410004.3" id="QQ2-1-74">Danny Tran</a></span>
<br />  <span class="subsectionToc" >4.4 <a 
href="#x1-420004.4" id="QQ2-1-75">Victor Zhou</a></span>
</div>
<!--l. 105--><p class="noindent" >
                                                                                         
                                                                                         
</p>
<h3 class="sectionHead"><span class="titlemark">1    </span> <a 
 id="x1-20001"></a>Abstract</h3>
<!--l. 107--><p class="noindent" >In this project, we started by using Mattias Müller’s Eulerian fluid simulator as base code.
We built upon this fluid simulator to include other physical properties in order to create a
more dynamic, realistic, and visually interesting simulation. Mattis Müller’s Eulerian fluid
simulator models the fluid as incompressible and inviscid. We added to this by implementing
vorticity to create a more realistic smoke simulation. We also implemented the interaction
of heat within the scene to model the effects of buoyancy due to variations in temperature.
Alongside these physics-based implementations, to create a more fun and practical simulation that
can be applied to 2D games, we modeled some of the smoke effects seen in the 2D mobile
game Boom Beach. Finally, we wrote various shaders to create visually appealing smoke
effects.
</p><!--l. 109--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">2    </span> <a 
 id="x1-30002"></a>Technical Approach</h3>
<!--l. 110--><p class="noindent" >We initially started with Mattis Müller’s Eulerian fluid simulator which models the fluid as a velocity
field on a grid. The velocities are stored in a staggered grid manner which means that the horizontal forces
are stored along the vertically standing sides of the walls and the vertical forces are stored along the
horizontally standing sides of the walls.
</p>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-3001r1"></a>
                                                                                         
                                                                                         
<!--l. 114--><p class="noindent" ><img 
src="images/staggered_grid.png" alt="PIC"  
width="234"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1: </span><span  
class="content">Staggered Grid Representation from Mattis Müller’s Video</span></figcaption><!--tex4ht:label?: x1-3001r1 -->
                                                                                         
                                                                                         
</figure>
<!--l. 118--><p class="noindent" >The general simulation starts off with updating the velocity of each cell with outward forces which in his
simulation is just gravity. Then Mattis Müller forces incompressibility by forcing the divergence to be 0
by adding and subtracting scalars accordingly, taking into account walls and obstacles through the
Guass-Seidel method.
</p>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-3002r2"></a>
                                                                                         
                                                                                         
<!--l. 122--><p class="noindent" ><img 
src="images/gauss_seidel.png" alt="PIC"  
width="234"  />
</p>
<figcaption class="caption" ><span class="id">Figure 2: </span><span  
class="content">An example of the Guass-Seidel Method from Mattis Müller’s Video</span></figcaption><!--tex4ht:label?: x1-3002r2 -->
                                                                                         
                                                                                         
</figure>
<!--l. 127--><p class="noindent" >The simulation also uses overrelaxation which multiplies the divergence by a scaling factor, which in this
case is <span 
class="zptmcm7m-x-x-120">o </span><span 
class="zptmcm7t-x-x-120">= 1</span><span 
class="zptmcm7m-x-x-120">.</span><span 
class="zptmcm7t-x-x-120">9</span>. Then the simulation performs semi-lagrangian advection. Generally, this is done
by advecting the density values stored in each cell. These steps are done at each time step.
For more information about the base Eulerian Fluid Simulator we used from Mattis Müller,
refer to the references. Note: When referring to the ’mass’ of smoke, we are referring to what
can be thought of as the amount of smoke in a cell and is related to the density in each cell.
<br 
class="newline" />We then build upon this fluid simulator by implementing Vorticity Confinement, Heat, and Buoyancy.
These make the fluid simulator more physically realistic and create a more visually appealing smoke.
Then we implement smoke grenades and flare grenades from the game, Boom Beach. We also
implemented various shaders that impact the appearance of the smoke. This section details the technical
approach to each of these additions to the source code.
</p>
<h4 class="subsectionHead"><span class="titlemark">2.1    </span> <a 
 id="x1-40002.1"></a>Vorticity Confinement</h4>
<!--l. 131--><p class="noindent" >In semi-lagrangian advection, we assume that our parcels of fluid travel in a straight path in between each
of our timesteps. However, this introduces viscosity in our non-viscous fluid, resulting in an uninteresting
laminar-like flow. To combat this, the method of vorticity confinement was initially invented by
Steinhoff to model aerial vortices in flights. Modern-day research has further developed upon this
method to include a hybrid technique that captures the strengths of both Lagrangian vortex
particle methods as well as Eulerian grid-based methods. In our project, we add upon Müller’s
fluid simulator to include vorticity confinement to generate a more life-like smoke with more
swirls.
</p><!--l. 133--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.1.1    </span> <a 
 id="x1-50002.1.1"></a>Relation to Navier-Stokes</h5>
<!--l. 134--><p class="noindent" >Navier-Stokes assumes incompressiblility in a fluid, and says
</p><!--l. 136--><p class="noindent" >
</p>
<div class="math-display" >
<img 
src="main0x.svg" alt="∂u                        2
∂t-+ (u⋅∇ )u+ ∇p ∕ρ =  μ∇  u+ f
" class="math-display"  /></div>
                                                                                         
                                                                                         
<!--l. 137--><p class="noindent" >
</p>
<div class="math-display" >
<img 
src="main1x.svg" alt="∇ ⋅u = 0.
" class="math-display"  /></div>
<!--l. 139--><p class="noindent" >Taking the curl of our first equation here, we can generate a vorticity version of it in the form
of
</p><!--l. 141--><p class="noindent" >
</p>
<div class="math-display" >
<img 
src="main2x.svg" alt="∂ ω
----+ (u ⋅∇)ω − (ω ⋅∇ )u = μ∇2 ω + ∇ × f.
 ∂t
" class="math-display"  /></div>
<!--l. 143--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.1.2    </span> <a 
 id="x1-60002.1.2"></a>Helper Functions</h5>
<!--l. 145--><p class="noindent" >In this function, we define the helper functions that we will later use for our vorticity confinement method.
We have our norm(arr) function that returns the l-2 norm of a given array, dot(arr1, arr2) function that
returns the dot product of two inputted arrays, and cross(arr1, arr2) function that returns the magnitude of
the cross product of two inputted arrays.
</p>
<!--l. 147-->
<pre class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-6001r1"></a></span><span style="color:#0000FF"><span 
class="cmtt-10">norm</span></span><span style="color:#000000"><span 
class="cmtt-10">(</span></span><span style="color:#0000FF"><span 
class="cmtt-10">arr</span></span><span style="color:#000000"><span 
class="cmtt-10">)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">{</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">//</span></span><span style="color:#0000FF"><span 
class="cmtt-10">l</span></span><span style="color:#000000"><span 
class="cmtt-10">-2</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">norm</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">of</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">array</span></span><span style="color:#000000"><span 
class="cmtt-10">/</span></span><span style="color:#0000FF"><span 
class="cmtt-10">vector</span></span><span 
class="cmtt-10"> </span><br /> 
<span class="label"><a 
 id="x1-6002r2"></a></span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span style="color:#0000FF"><span 
class="cmtt-10">var</span></span><span style="color:#000000"> </span><span style="color:#006600"><span 
class="cmtt-10">sum</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">0;</span></span><span 
class="cmtt-10"> </span><br /> 
<span class="label"><a 
 id="x1-6003r3"></a></span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span style="color:#006600"><span 
class="cmtt-10">for</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">(</span></span><span style="color:#0000FF"><span 
class="cmtt-10">var</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">i</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">0;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">i</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">&#x003C;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">arr</span></span><span style="color:#000000"><span 
class="cmtt-10">.</span></span><span style="color:#0000FF"><span 
class="cmtt-10">length</span></span><span style="color:#000000"><span 
class="cmtt-10">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">i</span></span><span style="color:#000000"><span 
class="cmtt-10">++)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">{</span></span><span 
class="cmtt-10"> </span><br /> 
<span class="label"><a 
 id="x1-6004r4"></a></span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span style="color:#006600"><span 
class="cmtt-10">sum</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">+=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">Math</span></span><span style="color:#000000"><span 
class="cmtt-10">.</span></span><span style="color:#006600"><span 
class="cmtt-10">pow</span></span><span style="color:#000000"><span 
class="cmtt-10">(</span></span><span style="color:#0000FF"><span 
class="cmtt-10">arr</span></span><span style="color:#000000"><span 
class="cmtt-10">[</span></span><span style="color:#0000FF"><span 
class="cmtt-10">i</span></span><span style="color:#000000"><span 
class="cmtt-10">],</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">2)</span></span><span style="color:#000000"><span 
class="cmtt-10">;</span></span><span 
class="cmtt-10"> </span><br /> 
<span class="label"><a 
 id="x1-6005r5"></a></span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span style="color:#000000"><span 
class="cmtt-10">}</span></span><span 
class="cmtt-10"> </span><br /> 
<span class="label"><a 
 id="x1-6006r6"></a></span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span style="color:#006600"><span 
class="cmtt-10">return</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">Math</span></span><span style="color:#000000"><span 
class="cmtt-10">.</span></span><span style="color:#0000FF"><span 
class="cmtt-10">sqrt</span></span><span style="color:#000000"><span 
class="cmtt-10">(</span></span><span style="color:#006600"><span 
class="cmtt-10">sum</span></span><span style="color:#000000"><span 
class="cmtt-10">)</span></span><span style="color:#000000"><span 
class="cmtt-10">;</span></span><span 
class="cmtt-10"> </span><br /> 
<span class="label"><a 
 id="x1-6007r7"></a></span><span style="color:#000000"><span 
class="cmtt-10">}</span></span><span 
class="cmtt-10"> </span><br /> 
<span class="label"><a 
 id="x1-6008r8"></a></span><span 
class="cmtt-10"> </span><br /> 
<span class="label"><a 
 id="x1-6009r9"></a></span><span style="color:#0000FF"><span 
class="cmtt-10">dot</span></span><span style="color:#000000"><span 
class="cmtt-10">(</span></span><span style="color:#0000FF"><span 
class="cmtt-10">arr1</span></span><span style="color:#000000"><span 
class="cmtt-10">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">arr2</span></span><span style="color:#000000"><span 
class="cmtt-10">)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">{</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">//</span></span><span style="color:#0000FF"><span 
class="cmtt-10">dot</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">product</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">of</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">two</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">vectors</span></span><span 
class="cmtt-10"> </span><br /> 
<span class="label"><a 
 id="x1-6010r10"></a></span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span style="color:#0000FF"><span 
class="cmtt-10">var</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">out</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">0;</span></span><span 
class="cmtt-10"> </span><br /> 
<span class="label"><a 
 id="x1-6011r11"></a></span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span style="color:#006600"><span 
class="cmtt-10">for</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">(</span></span><span style="color:#0000FF"><span 
class="cmtt-10">var</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">i</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">0;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">i</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">&#x003C;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">arr1</span></span><span style="color:#000000"><span 
class="cmtt-10">.</span></span><span style="color:#0000FF"><span 
class="cmtt-10">length</span></span><span style="color:#000000"><span 
class="cmtt-10">;</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">i</span></span><span style="color:#000000"><span 
class="cmtt-10">++)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">{</span></span><span 
class="cmtt-10"> </span><br /> 
<span class="label"><a 
 id="x1-6012r12"></a></span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span style="color:#0000FF"><span 
class="cmtt-10">out</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">+=</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">arr1</span></span><span style="color:#000000"><span 
class="cmtt-10">[</span></span><span style="color:#0000FF"><span 
class="cmtt-10">i</span></span><span style="color:#000000"><span 
class="cmtt-10">]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">*</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">arr2</span></span><span style="color:#000000"><span 
class="cmtt-10">[</span></span><span style="color:#0000FF"><span 
class="cmtt-10">i</span></span><span style="color:#000000"><span 
class="cmtt-10">];</span></span><span 
class="cmtt-10"> </span><br /> 
<span class="label"><a 
 id="x1-6013r13"></a></span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span style="color:#000000"><span 
class="cmtt-10">}</span></span><span 
class="cmtt-10"> </span><br /> 
<span class="label"><a 
 id="x1-6014r14"></a></span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span style="color:#006600"><span 
class="cmtt-10">return</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">out</span></span><span style="color:#000000"><span 
class="cmtt-10">;</span></span><span 
class="cmtt-10"> </span><br /> 
<span class="label"><a 
 id="x1-6015r15"></a></span><span style="color:#000000"><span 
class="cmtt-10">}</span></span><span 
class="cmtt-10"> </span><br /> 
<span class="label"><a 
 id="x1-6016r16"></a></span><span 
class="cmtt-10"> </span><br /> 
<span class="label"><a 
 id="x1-6017r17"></a></span><span style="color:#0000FF"><span 
class="cmtt-10">cross</span></span><span style="color:#000000"><span 
class="cmtt-10">(</span></span><span style="color:#0000FF"><span 
class="cmtt-10">arr1</span></span><span style="color:#000000"><span 
class="cmtt-10">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">arr2</span></span><span style="color:#000000"><span 
class="cmtt-10">)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">{</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">//</span></span><span style="color:#0000FF"><span 
class="cmtt-10">magnitude</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">of</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">cross</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">product</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">of</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">two</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">vectors</span></span><span 
class="cmtt-10"> </span><br /> 
<span class="label"><a 
 id="x1-6018r18"></a></span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span style="color:#006600"><span 
class="cmtt-10">return</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">this</span></span><span style="color:#000000"><span 
class="cmtt-10">.</span></span><span style="color:#0000FF"><span 
class="cmtt-10">norm</span></span><span style="color:#000000"><span 
class="cmtt-10">(</span></span><span style="color:#0000FF"><span 
class="cmtt-10">arr1</span></span><span style="color:#000000"><span 
class="cmtt-10">)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">*</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">this</span></span><span style="color:#000000"><span 
class="cmtt-10">.</span></span><span style="color:#0000FF"><span 
class="cmtt-10">norm</span></span><span style="color:#000000"><span 
class="cmtt-10">(</span></span><span style="color:#0000FF"><span 
class="cmtt-10">arr2</span></span><span style="color:#000000"><span 
class="cmtt-10">)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">*</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">Math</span></span><span style="color:#000000"><span 
class="cmtt-10">.</span></span><span style="color:#0000FF"><span 
class="cmtt-10">sin</span></span><span style="color:#000000"><span 
class="cmtt-10">(</span></span><span style="color:#0000FF"><span 
class="cmtt-10">Math</span></span><span style="color:#000000"><span 
class="cmtt-10">.</span></span><span style="color:#0000FF"><span 
class="cmtt-10">acos</span></span><span style="color:#000000"><span 
class="cmtt-10">(</span></span><span style="color:#0000FF"><span 
class="cmtt-10">this</span></span><span style="color:#000000"><span 
class="cmtt-10">.</span></span><span style="color:#0000FF"><span 
class="cmtt-10">dot</span></span><span style="color:#000000"><span 
class="cmtt-10">(</span></span><span style="color:#0000FF"><span 
class="cmtt-10">arr1</span></span><span style="color:#000000"><span 
class="cmtt-10">,</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">arr2</span></span><span style="color:#000000"><span 
class="cmtt-10">)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">/</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">(</span></span><span style="color:#0000FF"><span 
class="cmtt-10">this</span></span><span style="color:#000000"><span 
class="cmtt-10">.</span></span><span style="color:#0000FF"><span 
class="cmtt-10">norm</span></span><span style="color:#000000"><span 
class="cmtt-10">(</span></span><span style="color:#0000FF"><span 
class="cmtt-10">arr1</span></span><span style="color:#000000"><span 
class="cmtt-10">)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="cmtt-10">*</span></span><span style="color:#000000"> </span><span style="color:#0000FF"><span 
class="cmtt-10">this</span></span><span style="color:#000000"><span 
class="cmtt-10">.</span></span><span style="color:#0000FF"><span 
class="cmtt-10">norm</span></span><span style="color:#000000"><span 
class="cmtt-10">(</span></span><span style="color:#0000FF"><span 
class="cmtt-10">arr2</span></span><span style="color:#000000"><span 
class="cmtt-10">)</span></span><span style="color:#000000"><span 
class="cmtt-10">)</span></span><span style="color:#000000"><span 
class="cmtt-10">)</span></span><span style="color:#000000"><span 
class="cmtt-10">)</span></span><span style="color:#000000"><span 
class="cmtt-10">;</span></span><span 
class="cmtt-10"> </span><br /> 
<span class="label"><a 
 id="x1-6019r19"></a></span><span style="color:#000000"><span 
class="cmtt-10">}</span></span></pre>
<!--l. 169--><p class="noindent" >The cross product uses the equation
</p><!--l. 171--><p class="noindent" >
                                                                                         
                                                                                         
</p>
<div class="math-display" >
<img 
src="main3x.svg" alt="    ⃗         ⃗
∥⃗a× b ∥ = ∥⃗a∥∥b∥ sin(α ),
" class="math-display"  /></div>
<!--l. 173--><p class="noindent" >where <span 
class="zptmcm7m-x-x-120">α </span>is defined as the angle between our two vectors. To find alpha, we use the equation
</p><!--l. 175--><p class="noindent" >
</p>
<div class="math-display" >
<img 
src="main4x.svg" alt="           (        )
             --⃗a⋅⃗b--
α  = arccos      ⃗    ,
             ∥⃗a∥∥ b∥
" class="math-display"  /></div>
<!--l. 177--><p class="noindent" >which can be seen to be true through the projection equation.
</p><!--l. 179--><p class="noindent" >Our last helper function is curl(x, y, direction = 1), which calculates the curl at any given
location <span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">x,y</span><span 
class="zptmcm7t-x-x-120">)</span>. Since our fluid’s velocity vectors are dependent on many different factors, it is
rather difficult and potentially computationally expensive to calculate our curl as specifically
<span 
class="zptmcm7m-x-x-120">ω </span><span 
class="zptmcm7t-x-x-120">= </span><span 
class="zptmcm7y-x-x-120">∇×</span><span class='accentvec'><span 
class="zptmcm7m-x-x-120">u</span></span> and then calculate the gradient of it. Thus, we instead take our curl to be the physical
velocity in rotation around it. More specifically, for a location <span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">x,y</span><span 
class="zptmcm7t-x-x-120">)</span>, we calculate it as the
sums
</p><!--l. 181--><p class="noindent" >
</p>
<div class="math-display" >
<img 
src="main5x.svg" alt="curl[x] = − v [x,y+ 1]+ v [x,y− 1]
            x           x
" class="math-display"  /></div>
<!--l. 182--><p class="noindent" >
                                                                                         
                                                                                         
</p>
<div class="math-display" >
<img 
src="main6x.svg" alt="curl[y] = − vy[x − 1,y]+ vy[x + 1,y].
" class="math-display"  /></div>
<!--l. 184--><p class="noindent" >These equations offer the curl for the standard notation of counterclockwise rotation about <span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">x,y</span><span 
class="zptmcm7t-x-x-120">)</span>, and if
interested, we can instead change our direction variable away from the default value of <span 
class="zptmcm7t-x-x-120">1 </span>to exhibit curl
for clockwise rotation.
</p><!--l. 186--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.1.3    </span> <a 
 id="x1-70002.1.3"></a>Implementation of Steinhoff’s Vorticity Confinement</h5>
<!--l. 187--><p class="noindent" >At a high level, at each point in our grid, we’re looking to first generate the vorticity as <span 
class="zptmcm7m-x-x-120">ω </span><span 
class="zptmcm7t-x-x-120">= </span><span 
class="zptmcm7y-x-x-120">∇×</span><span 
class="zptmcm7m-x-x-120">u</span>. Then,
we calculate the vorticity location vector that point from lower to higher vorticity concentrations,
<span 
class="zptmcm7m-x-x-120">η </span><span 
class="zptmcm7t-x-x-120">= </span><span 
class="zptmcm7y-x-x-120">∇|</span><span 
class="zptmcm7m-x-x-120">ω</span><span 
class="zptmcm7y-x-x-120">|</span>, and normalize it to get <span 
class="zptmcm7m-x-x-120">N </span><span 
class="zptmcm7t-x-x-120">=</span> <img 
src="main7x.svg" alt="∥ηη∥"  class="frac" align="middle" />. Finally, we generate our force vector for that grid point as
<span 
class="zptmcm7m-x-x-120">f </span><span 
class="zptmcm7t-x-x-120">= </span><span 
class="zptmcm7m-x-x-120">𝜖h</span><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">N </span><span 
class="zptmcm7y-x-x-120">×</span><span 
class="zptmcm7m-x-x-120">ω</span><span 
class="zptmcm7t-x-x-120">)</span>, where <span 
class="zptmcm7m-x-x-120">𝜖 </span>is our constant to control the degree of effect, and <span 
class="zptmcm7m-x-x-120">h </span>is the size of the grid.
Written out, we have
</p><!--l. 189--><p class="noindent" >
</p>
<div class="math-display" >
<img 
src="main8x.svg" alt="ω = ∇ × u
" class="math-display"  /></div>
<!--l. 190--><p class="noindent" >
</p>
<div class="math-display" >
<img 
src="main9x.svg" alt="N  = -η--     (η = ∇ |ω |)
     ∥η ∥
" class="math-display"  /></div>
<!--l. 191--><p class="noindent" >
</p>
<div class="math-display" >
<img 
src="main10x.svg" alt="f = 𝜖h (N × ω).
" class="math-display"  /></div>
<!--l. 193--><p class="noindent" >To implement vorticity confinement, we first generate the curls at each point on our grid at the current
timestep by calling our curl helper function. We store these in our array of size <span 
class="zptmcm7m-x-x-120">height </span><span 
class="zptmcm7y-x-x-120">∗</span><span 
class="zptmcm7m-x-x-120">width </span>(same size
as arrays for our velocity values). Next, we generate the gradients by taking the absolute value of
the difference between the current timestep and previous timestep’s curl values and divide
it all by our timestep size <span 
class="zptmcm7m-x-x-120">dt</span>, and then normalize it by dividing the new vector by its norm.
Finally, we generate the force as per the equation, with <span 
class="zptmcm7m-x-x-120">𝜖 </span>taking on the value of <span 
class="zptmcm7t-x-x-120">1</span><span 
class="zptmcm7m-x-x-120">.</span><span 
class="zptmcm7t-x-x-120">3 </span>in our
code.
</p><!--l. 195--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.1.4    </span> <a 
 id="x1-80002.1.4"></a>Converting Vorticity Confinement to Velocity</h5>
<!--l. 196--><p class="noindent" >With the force calculated, we now need to make sure it’s reflected in the smoke’s velocity. To do this, we
can use Newton’s Second Law, which states <span 
class="zptmcm7m-x-x-120">F </span><span 
class="zptmcm7t-x-x-120">= </span><span 
class="zptmcm7m-x-x-120">ma</span>, to find the acceleration, and multiply that by our
timestep <span 
class="zptmcm7m-x-x-120">dt </span>to receive how much our velocity should change by. To find our mass, we find out how much
fluid is flowing into our given grid point by using the inwards velocity. With our new velocity change
<span 
class="zptmcm7m-x-x-120">dt </span><span 
class="zptmcm7y-x-x-120">∗</span><img 
src="main11x.svg" alt="fmorcases"  class="frac" align="middle" />, we scale it by our <span 
class="zptmcm7m-x-x-120">𝜖 </span>constant (<span 
class="zptmcm7t-x-x-120">1</span><span 
class="zptmcm7m-x-x-120">.</span><span 
class="zptmcm7t-x-x-120">3 </span>here) and add each component of velocity change to their
respective components.
</p><!--l. 198--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.1.5    </span> <a 
 id="x1-90002.1.5"></a>Struggles and Resolutions</h5>
<!--l. 199--><p class="noindent" >In implementing vorticity confinement, a consistent problem that persisted was type errors arising from
intermixing our constants with our arrays.
</p><!--l. 201--><p class="noindent" >Outside of those, the first biggest problem was trying to calculate our curl, since we could not easily find
<span 
class="zptmcm7y-x-x-120">∇×</span><span 
class="zptmcm7m-x-x-120">u </span>if our <span 
class="zptmcm7m-x-x-120">u </span>is based on so many functions. Thus, we took it to be the physical rotational velocity (of
radius <span 
class="zptmcm7m-x-x-120">r </span><span 
class="zptmcm7t-x-x-120">= 1</span>) as described in <a 
href="#x1-60002.1.2">section 2.1.2</a>.
                                                                                         
                                                                                         
</p><!--l. 203--><p class="noindent" >Following that, in order to take the gradient of the curl (which faces problems similar to finding the curl
itself), because of our previous implementation of curl, we’re able to simply store the previous
timestep’s curls and find their difference from the current curl and divide that by our timestep,
<span 
class="zptmcm7m-x-x-120">dt</span>.
</p><!--l. 205--><p class="noindent" >There also existed the problem of trying to find an explicit mass for each grid point’s fluid, so we utilized
the inwards flow into each grid since we can use conservation of flow and the fact that our fluid is
incompressible.
</p><!--l. 207--><p class="noindent" >For the cross product <span 
class="zptmcm7m-x-x-120">N </span><span 
class="zptmcm7y-x-x-120">×</span><span 
class="zptmcm7m-x-x-120">ω</span>, in a normal 3D space, the cross product generates a vector that is
perpendicular to the given two vectors. However, in our 2D grid space, this new vector will not lie on the
same plane, and so we instead used the magnitude of the cross product and assumed that the vertical
and horizontal components would both experience a force directly proportional to that same
value.
</p><!--l. 209--><p class="noindent" >Finally, our code has to deal with edge case conditions. Without some of our edge cases resolved, our
screen becomes fully black due to division by <span 
class="zptmcm7t-x-x-120">0 </span>or just extremely small numbers in general.
</p><!--l. 211--><p class="noindent" >Because of our approximations and how we implemented some of the mathematical equations, our
vorticity forces sometimes didn’t feel strong enough. As a result, we ”hacked” the forces to
be stronger than they perhaps should be by always taking accelerating forces for vorticity
confinement forces. This can create some weird scenes, such as smoke always seeming to drift to the
right.
</p><!--l. 213--><p class="noindent" >The process of debugging each of these issues that arose in vorticity confinement resulted in a lot of
stepping through the logic of our code bit by bit and considering possible problems and outcomes at each
point. In some cases, the console.log() function was used to try to locate the source of our problems, but
because of the nature of the nested for loops with our code, this was an extremely slow and tedious
process.
</p><!--l. 215--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.2    </span> <a 
 id="x1-100002.2"></a>Heat and Buoyancy</h4>
<!--l. 216--><p class="noindent" >When planning the project, we had the ambition to implement fire. However, a realistic fire proved to be
too complex for us with the existing fluid simulation as we struggled to connect density, pressure, and
temperature using real physics. Despite this, we did find methods of applying aspects of heat and fire to
our simulation.
</p><!--l. 218--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.2.1    </span> <a 
 id="x1-110002.2.1"></a>Spread of Heat</h5>
<!--l. 219--><p class="noindent" >Heat spreads via conduction, convection, or radiation. To begin with, we created a simple version of
radiation. As our simulation is a conceptual fluid, we took inspiration from the equation for
radiation:
                                                                                         
                                                                                         
</p>
<div class="math-display" >
<img 
src="main12x.svg" alt="                4
Q ∕t = σ ⋅e ⋅A ⋅T
" class="math-display"  /></div>
<!--l. 221--><p class="noindent" >But we ignored constants and material properties to produce a very easy formula. Our equation for
radiation was simply:
</p>
<div class="math-display" >
<img 
src="main13x.svg" alt="tem p of a cell X = con stant * (temp in surround ing cells - tem p of &#x0
" class="math-display"  /></div>
<!--l. 224--><p class="noindent" >If the cell was cooler than its surrounding cells then it would heat up and vice versa if it was hotter than its
surrounding cells.
</p><!--l. 226--><p class="noindent" >To implement convection, we attempted to relate temperature to the existing density and pressure
matrices, but we found with how the simulation was already designed, it did not allow a simple
incorporation of heat relating directly to the other attributes. We tried to use the equation:
</p>
<div class="math-display" >
<img 
src="main14x.svg" alt="pressure = d ensity∗ R ∗tem pera ture
" class="math-display"  /></div>
<!--l. 229--><p class="noindent" >But the existing values and calculations performed regarding pressure and density were somewhat
arbitrary, and attempting to set new values in one location would cause problems in other areas.
Therefore, to connect the movement of smoke to the movement of heat, we enforced small
changes in temperature relative to the velocity of the cell. If the velocity has a net upwards or
sideways direction then some extra temperature change is emphasized in the direction of net
velocity. The equation for this is very similar to the one used for radiation, but the cell only adds
temperature away from the direction of velocity. In other words, if the net velocity is right, the cell
                                                                                         
                                                                                         
adds:
</p>
<div class="math-display" >
<img 
src="main15x.svg" alt="constant∗velocity ∗(temp of left cell - tem p of cell X )
" class="math-display"  /></div>
<!--l. 232--><p class="noindent" >This effect is particularly noticeable in the wind tunnel. In the dead room, it creates small wisps of
movement in the heat as smoke passes by it.
</p><!--l. 234--><p class="noindent" >We also included a tendency for our heat to spread upwards. This was done to make the heat more closely
resemble a hot flame.
</p><!--l. 236--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.2.2    </span> <a 
 id="x1-120002.2.2"></a>Buoyancy</h5>
<!--l. 237--><p class="noindent" >The only effect our heat has on the movement of the smoke is the existence of buoyancy. In reality,
buoyancy occurs with the presence of a difference in temperature, and therefore density. Our code slightly
alters density in relation to heat by adding or subtracting from the starting density value based on the
difference in temperature between its current temperature and the starting temperature. The starting
temperature is 0.3 and the starting density is 1000. Therefore, if the temperature is higher than
0.3, the density is lowered by a constant * (temp - 0.3 / 0.3) * 1000. We implemented this
phenomenon but it has little effect on the appearance of the simulation. Rather than relating buoyancy
to density, we directly related it to the difference in temperature between a cell and the cell
above it. The total upwards force calculated at each time step due to gravity and buoyancy
was:
</p>
<div class="math-display" >
<img 
src="main16x.svg" alt="v directio n acceleration = buoyancy constant∗(tem p of cell X− te&#x0
" class="math-display"  /></div>
                                                                                         
                                                                                         
<!--l. 240--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.2.3    </span> <a 
 id="x1-130002.2.3"></a>Practicalities of Adding Heat</h5>
<!--l. 241--><p class="noindent" >We wrote a few extra functions to implement heat in our simulation in practice. We added a function that
would ”set fire” to any solid objects in the scene. For our demonstration, the only solid object we
use is a ball. We increase the heat to 1.0 throughout the solid ball as well as the fluid on its
edges. We also add smoke to the edges of the ball for demonstration purposes. This gives the
impression that the ball is on fire, or at the very least it is continuously producing heat and
smoke.
</p><!--l. 243--><p class="noindent" >We also introduced a function that would, over time, reduce the temperature of a cell back to the
starting number of 0.3. This was done simply by taking the difference between the cell and the
starting number and multiplying this by a very small constant. In our simulation which takes
place in a closed room, this means the heat does not fill the entire room. Rather, it resembles a
flame.
</p><!--l. 246--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.2.4    </span> <a 
 id="x1-140002.2.4"></a>If We Could Expand</h5>
<!--l. 247--><p class="noindent" >If we had more time, there are other simple ideas we would have tried to implement related to fire. Rather
than placing a ball that produces infinite heat, we wanted to simulate the spread of fire by placing multiple
objects in the scene which would represent combustible materials. These materials would have had a
certain energy that could be released into the scene at a particular rate, and over time would
release heat until they ran out of energy. We also wanted to allow these objects to catch fire
only above a certain threshold of heat which would be provided by an outside source e.g. an
explosion or another object on fire. These properties would be vaguely imitating the true physics
equation:
</p>
<div class="math-display" >
<img 
src="main17x.svg" alt="q = mass ∗specific heat∗chang e in tem perature
" class="math-display"  /></div>
<!--l. 250--><p class="noindent" >We would have also wanted to change the appearance of the smoke itself according to heat rather than
solely changing its velocity. This is partially the intent of the fire heat shader which is outlined in the
shaders section, but ultimately we could not figure out how to realistically alter the color of the smoke
according to heat.
                                                                                         
                                                                                         
</p><!--l. 253--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.3    </span> <a 
 id="x1-150002.3"></a>Game Effects</h4>
<!--l. 254--><p class="noindent" >Alongside the physics-based implementations of vorticity, heat, and buoyancy, we used our smoke
simulator to emulate some of the smoke effects of the video Boom Beach by SuperCell. Namely, we try to
implement smoke grenade and flare grenade from the game.
</p><!--l. 256--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.3.1    </span> <a 
 id="x1-160002.3.1"></a>Smoke Grenade</h5>
<!--l. 257--><p class="noindent" >In Boom Beach, smoke grenades are deployed at a certain spot and appear as a circular gray cloud with a
lighter ring enclosing the smoke. These smokes last for a little while depending on the level of your smoke
and then disappear. We initially struggled to find a way to both make these smokes appear and then
disappear after a certain amount of time. In order to do this, we implemented time which we stored as a
scene variable. We would then get the spot where the user clicked and would deploy the smoke grenade
with different shades in the circle using techniques very similar to checking the intersection of the cloth
with the sphere in project 4. We instantiated this smoke with a very small velocity that keeps the
smoke in place for the duration and creates small movements similar to the boom beach smoke
grenade. While implementing this, we ran into the problem that when we had overlapping smoke
grenades the dissipating smoke grenade would clear the others. In order to solve this, we stored
the center position and deployment time in a list of active smokes and created a function to
clear smokes that would iterate through all the other smokes to check whether a position was
in the radius of an active smoke. With this implementation, placing the smoke down would
take <span 
class="zptmcm7m-x-x-120">O</span><span 
class="zptmcm7t-x-x-120">(1) </span>time and clearing the smokes would take <span 
class="zptmcm7m-x-x-120">O</span><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">n</span><span 
class="zptmcm7t-x-x-120">) </span>(where n is the number of smokes
placed) time as we iterated through all the active smokes. This could be problematic as there are
more and more smokes but our computers this was not really an issue for even around 20
smokes.
</p>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-16001r3"></a>
                                                                                         
                                                                                         
<!--l. 261--><p class="noindent" ><img 
src="images/smoke_grenade_diagram.png" alt="PIC"  
width="400"  />
</p>
<figcaption class="caption" ><span class="id">Figure 3: </span><span  
class="content">General Implementation of our smoke grenades</span></figcaption><!--tex4ht:label?: x1-16001r3 -->
                                                                                         
                                                                                         
</figure>
<h5 class="subsubsectionHead"><span class="titlemark">2.3.2    </span> <a 
 id="x1-170002.3.2"></a>Flare Grenade</h5>
<!--l. 267--><p class="noindent" >In Boom Beach, flare grenades are deployed at a certain spot and appear as a spot dissipating a lightly
pink colored smoke. Similar to smoke grenades these smokes last for a little while depending on their
level and then stop shooting up smoke. We implemented this very similarly to the smoke grenades with
some minor differences. The general pipeline goes as so, when the user clicks at a spot we add the x and y
location of the click alongside the time clicked to the active flares. Then at every time step we run
a function called displayFlareGrenades that starts off with calling another function called
clearFlareGrenades that goes through the active flare grenades and removes any that are past
their time limit from the list of active flare grenades. This displayFlareGrenades function then
places smoke at the source of each flare grenade with some upward velocity. As the simulation
goes on the smoke will flow upward as the bottom is continually ’supplied’ with more smoke.
With this implementation, placing the flare grenade takes <span 
class="zptmcm7m-x-x-120">O</span><span 
class="zptmcm7t-x-x-120">(</span><span 
class="zptmcm7m-x-x-120">n</span><span 
class="zptmcm7t-x-x-120">) </span>(where n is the number of
flare grenades placed) time as each time the flare grenade is displayed it has to check all the
flaregrenades to check whether they should still be active or not. We had initially run into
issues about only removing the flare grenade from the list of activeFlares like in the smoke
implementation but realized we had to do a constant check for the flare grenade due to its
nature.
</p>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-17001r4"></a>
                                                                                         
                                                                                         
<!--l. 271--><p class="noindent" ><img 
src="images/flare_grenade_diagram.png" alt="PIC"  
width="400"  />
</p>
<figcaption class="caption" ><span class="id">Figure 4: </span><span  
class="content">General Implementation of our flare grenades</span></figcaption><!--tex4ht:label?: x1-17001r4 -->
                                                                                         
                                                                                         
</figure>
<h5 class="subsubsectionHead"><span class="titlemark">2.3.3    </span> <a 
 id="x1-180002.3.3"></a>Boom Beach Background</h5>
<!--l. 277--><p class="noindent" >In Boom Beach Background, when we first implemented the smoke and the flare into the
boom beach background, the smoke and the flare would cover up the image and instead of
looking like a smoke, it looked more like a white circle. We used the RGBA specifically the
A values to control the transparency of the circle. We thought that 150 was the best value
for transparency because it was able to recreate the most boombeach-like smoke and flare
grenade. In addition to this, the smoke and the flare grenade generated extra smoke that would
spread across the background. In order to prevent this, we created a threshold value for smoke
and flare grenades. If the pixel value of the smoke is greater than the threshold value, then
we take the original background pixel data, and if it isn’t then we take the calculated pixel
value.
</p><!--l. 279--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.4    </span> <a 
 id="x1-190002.4"></a>Shaders</h4>
<!--l. 280--><p class="noindent" >We created various shaders that alter the appearance of our smoke simulation in different ways. We
primarily implemented these by changing the way that cells are drawn based on factors such as the ’mass’
and velocity of the cell. We created shader functions that would take in information for the cell and return
a color that would shade in the cell at that spot. While implementing this, we had trouble
figuring out the technical approach to shaders in Three.js. We wanted to use the correct in-built
functions which would allow full utilization of the GPU. However, upon closer examination of
how the canvas was being drawn on, we went with the methods described in the following
sections.
</p><!--l. 282--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.4.1    </span> <a 
 id="x1-200002.4.1"></a>Smoke Color Shader</h5>
<!--l. 283--><p class="noindent" >The smoke color shader is a very simple shader and is entirely dependent on the ’mass’ of the cell. This
shader takes in a color and scales the color by the ’mass’ of the cell. This creates a smoke of the selected
color on a black background. In this shader, the RGB values are scaled by the ’mass’ of this function
while the A value remains at 255. We had initially played around with making the A value scale with the
mass, but found that the smoke looked better with the A value remaining constant at 255. This is
accomplished by following rule in pseudocode:
</p>
                                                                                         
                                                                                         
<div class="math-display" >
<img 
src="main18x.svg" alt="color = [’m ass’ ∗sm okeCo lor[0],’m ass’∗sm okeC olor[1],’mass’∗ sm&
" class="math-display"  /></div>
<!--l. 286--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.4.2    </span> <a 
 id="x1-210002.4.2"></a>Blocky Shader</h5>
<!--l. 287--><p class="noindent" >The inspiration for this shader was to create a more ’cartoonish’ smoke. This was achieved by creating a
shader the filtered out all the smoke cells that have little ’mass’ and displaying the cells as the color
regardless of the mass. This creates a smoke that is missing a lot of the small typical ’wispy’ smoke effects
creating a more ’cartoonish’ and blocky look to the smoke.
</p><!--l. 289--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.4.3    </span> <a 
 id="x1-220002.4.3"></a>Van Gogh Inspired Shader</h5>
<!--l. 290--><p class="noindent" >The Van Gogh inspired shader is inspired from Van Gogh’s Painting, The Starry Night, and the multiple of
different lines making up the sky and clouds. In order to create a somewhat similar aesthetic, we
created a shader that thresholded the various ’mass’ displaying a certain color from the general
color palette of The Starry night. This creates small streaks that somewhat resemble the style
from Van Gogh. Most the trouble of implementing this shader came from the thresholds and
setting the colors. We initially set these thresholds to be very large which did not create enough
small streaks, eventually making them smaller and included more colors of the color palette.
</p><figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-22001r5"></a>
                                                                                         
                                                                                         
<!--l. 293--><p class="noindent" ><img 
src="images/thestarrynight.png" alt="PIC"  
width="400"  />
</p>
<figcaption class="caption" ><span class="id">Figure 5: </span><span  
class="content">The Starry Night by Van Gogh</span></figcaption><!--tex4ht:label?: x1-22001r5 -->
                                                                                         
                                                                                         
</figure>
<h5 class="subsubsectionHead"><span class="titlemark">2.4.4    </span> <a 
 id="x1-230002.4.4"></a>Phong Model Inspired Shader</h5>
<!--l. 299--><p class="noindent" >The Phong Model Inspired Shader simulates the scene where there is a point light at the bottom left point
of the canvas. We used the Blinn Phong Shading Equation as a base:
</p>
<div class="math-display" >
<img 
src="main19x.svg" alt="                2                    2            p
L = kaIa+ kd(I∕r )max (0,n⋅l)+ ks(I∕r )max (0,n ⋅h)
" class="math-display"  /></div>
<!--l. 301--><p class="noindent" >We defined the constants as:
</p>
<div class="math-display" >
<img 
src="main20x.svg" alt="L ig ht Position : [0.0,0.0,0.0]
" class="math-display"  /></div>
<!--l. 303--><p class="noindent" >
</p>
<div class="math-display" >
<img 
src="main21x.svg" alt="C amera Position : [W idth∕2.0,H eight∕2.0,0.0]
" class="math-display"  /></div>
<!--l. 304--><p class="noindent" >
                                                                                         
                                                                                         
</p>
<div class="math-display" >
<img 
src="main22x.svg" alt="Lo cation (can vas coordinates) : [x,y,0]
" class="math-display"  /></div>
<!--l. 305--><p class="noindent" >
</p>
<div class="math-display" >
<img 
src="main23x.svg" alt="ka = 0.1,ks = 0.5,p = 100
" class="math-display"  /></div>
<!--l. 306--><p class="noindent" >
</p>
<div class="math-display" >
<img 
src="main24x.svg" alt="kd = [1.0, 1.0,1.0]
" class="math-display"  /></div>
<!--l. 307--><p class="noindent" >
</p>
<div class="math-display" >
<img 
src="main25x.svg" alt="I  = [1.0,1.0,1.0]
 a
" class="math-display"  /></div>
                                                                                         
                                                                                         
<!--l. 308--><p class="noindent" >The shader takes in the mass, velocity = <span 
class="zptmcm7t-x-x-120">[</span><span 
class="zptmcm7m-x-x-120">u,v</span><span 
class="zptmcm7t-x-x-120">]</span>, and location.
</p>
<!--l. 309--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-240002.4.4"></a><span 
class="ptmb7t-x-x-120">Ambient Lighting</span></span>
We just compute ambLighting <span 
class="zptmcm7t-x-x-120">= </span><span 
class="zptmcm7m-x-x-120">k</span><sub><span 
class="zptmcm7m-x-x-90">a</span></sub><span 
class="zptmcm7m-x-x-120">I</span><sub><span 
class="zptmcm7m-x-x-90">a</span></sub> using the constants defined above.
</p>
<!--l. 311--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-250002.4.4"></a><span 
class="ptmb7t-x-x-120">Diffuse Reflection</span></span>
For the diffuse reflection we add a scaling factor of <span 
class="zptmcm7t-x-x-120">100</span><span 
class="zptmcm7y-x-x-120">∗</span> mass. We also computed <span 
class="zptmcm7m-x-x-120">I </span><span 
class="zptmcm7t-x-x-120">= [0</span><span 
class="zptmcm7m-x-x-120">.</span><span 
class="zptmcm7t-x-x-120">5</span><span 
class="zptmcm7m-x-x-120">,</span><span 
class="zptmcm7t-x-x-120">0</span><span 
class="zptmcm7m-x-x-120">.</span><span 
class="zptmcm7t-x-x-120">5</span><span 
class="zptmcm7m-x-x-120">,</span><span 
class="zptmcm7t-x-x-120">0</span><span 
class="zptmcm7m-x-x-120">.</span><span 
class="zptmcm7t-x-x-120">5] </span>and the
normal at each position to be pointing in the position z direction so v_normal_normalize <span 
class="zptmcm7t-x-x-120">=</span> normalize<span 
class="zptmcm7t-x-x-120">([</span><span 
class="zptmcm7m-x-x-120">x,y,</span><span 
class="zptmcm7t-x-x-120">1</span><span 
class="zptmcm7m-x-x-120">.</span><span 
class="zptmcm7t-x-x-120">0])</span>.
This left the equation to be:
</p>
<div class="math-display" >
<img 
src="main26x.svg" alt="      2
kd(I∕r )max (0,n⋅l)
" class="math-display"  /></div>
<!--l. 314--><p class="noindent" >where r is the distance from the light and <span 
class="zptmcm7m-x-x-120">n </span><span 
class="zptmcm7t-x-x-120">= </span><span 
class="zptmcm7m-x-x-120">max</span><span 
class="zptmcm7t-x-x-120">(0</span><span 
class="zptmcm7m-x-x-120">,dot</span><span 
class="zptmcm7t-x-x-120">(</span>v_normal_normalize<span 
class="zptmcm7m-x-x-120">,</span>lightVec<span 
class="zptmcm7t-x-x-120">)) </span>where lightVec
= <span 
class="zptmcm7m-x-x-120">l </span>is the vector from the point to the point light. This leaves the changed equation for the diffuse
reflection to be:
</p>
<div class="math-display" >
<img 
src="main27x.svg" alt="                         2
d iff useRefle ction = kd(I∕r )max(0,n ⋅l)∗100.0 ∗mass
" class="math-display"  /></div>
<!--l. 316--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-260002.4.4"></a><span 
class="ptmb7t-x-x-120">Specular Highlights</span></span>
We implemented the specular highlights using typical equation but also adding a scaling factor of
mass <span 
class="zptmcm7y-x-x-120">∗</span> norm(velocity). We define some helper variables:
                                                                                         
                                                                                         
</p>
<div class="math-display" >
<img 
src="main28x.svg" alt="           2
store = (I∕r )⋅ks
" class="math-display"  /></div>
<!--l. 319--><p class="noindent" >
</p>
<div class="math-display" >
<img 
src="main29x.svg" alt="v = normalize(C am era Po sition - Location )
" class="math-display"  /></div>
<!--l. 320--><p class="noindent" >
</p>
<div class="math-display" >
<img 
src="main30x.svg" alt="h = normalize(lightVec + v)
" class="math-display"  /></div>
<!--l. 321--><p class="noindent" >
</p>
<div class="math-display" >
<img 
src="main31x.svg" alt="maxV al = max (0,n ⋅h )p
" class="math-display"  /></div>
                                                                                         
                                                                                         
<!--l. 322--><p class="noindent" >
</p>
<div class="math-display" >
<img 
src="main32x.svg" alt="sp ecHighlig htT emp = m axV al∗store
" class="math-display"  /></div>
<!--l. 323--><p class="noindent" >Leaving the final value for the specular highlight to be:
</p>
<div class="math-display" >
<img 
src="main33x.svg" alt="specH ighligh t = specH ig hlightTem pt∗m ass∗ norm (v elocity)
" class="math-display"  /></div>
<!--l. 325--><p class="noindent" >Leaving the final color assignment to be:
</p>
<div class="math-display" >
<img 
src="main34x.svg" alt="outC olor = am bL ig hting + diff useRefl ection + specHighlight
" class="math-display"  /></div>
<!--l. 327--><p class="noindent" >
</p>
                                                                                         
                                                                                         
<div class="math-display" >
<img 
src="main35x.svg" alt="ou tC olor = [outColor[0]∗ 255,outColor[1]∗255, outColor[2]∗255, 255]
" class="math-display"  /></div>
<!--l. 329--><p class="noindent" >Generally, we scaled the diffuse reflection by the mass to create a lighting effect that made more dense
smoke more highlighted. We also scaled the specular highlights by the mass and velocity in order to
possibly highlight the bright spots on a smoke based on the movement and amount of smoke. While
these are not based on any particular equations we played around with variations to the Blinn
Phong shading base to achieve a visibly desirable effect. While coding up this, we ran into
various issues about the shader not being visible until we played around with constants in
the diffuse reflection and specular highlights. In addition, we also tried to implement this
leaving the z position out but found that we needed to include it. We primarily debugged and
messed around with the shaders using console.log to check the values and play around with
them.
</p><!--l. 331--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.4.5    </span> <a 
 id="x1-270002.4.5"></a>Heat Shader</h5>
<!--l. 332--><p class="noindent" >This shader simply takes in the heat value of a cell and alters the appearance solely according to that
value. This shader does not alter the appearance of smoke in the scene as our implementation of
temperature is independent from m. This shader causes the measure of heat to resemble fire by assigning a
color to a certain level of heat and lerping between these rings of color to create a smooth
appearance.
</p><!--l. 334--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">3    </span> <a 
 id="x1-280003"></a>Results</h3>
<!--l. 335--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.1    </span> <a 
 id="x1-290003.1"></a>Vorticity</h4>
<!--l. 336--><p class="noindent" >Normally, we use <span 
class="zptmcm7m-x-x-120">𝜖 </span><span 
class="zptmcm7t-x-x-120">= 1</span><span 
class="zptmcm7m-x-x-120">.</span><span 
class="zptmcm7t-x-x-120">3</span>. At <span 
class="zptmcm7m-x-x-120">𝜖 </span><span 
class="zptmcm7t-x-x-120">= 2</span><span 
class="zptmcm7m-x-x-120">.</span><span 
class="zptmcm7t-x-x-120">0 </span>and above, the wind tunnel smoke eventually diverges to completely
go upwards off the page. See below for images. </p><figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-29001r6"></a>
                                                                                         
                                                                                         
<!--l. 339--><p class="noindent" ><img 
src="images/beforeConfinement.png" alt="PIC"  
width="400"  />
</p>
<figcaption class="caption" ><span class="id">Figure 6: </span><span  
class="content">Wind tunnel without vorticity confinement</span></figcaption><!--tex4ht:label?: x1-29001r6 -->
                                                                                         
                                                                                         
</figure>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-29002r7"></a>
                                                                                         
                                                                                         
<!--l. 344--><p class="noindent" ><img 
src="images/afterConfinement.png" alt="PIC"  
width="400"  />
</p>
<figcaption class="caption" ><span class="id">Figure 7: </span><span  
class="content">Wind tunnel with confinement, <span 
class="zptmcm7m-x-x-120">𝜖 </span><span 
class="zptmcm7t-x-x-120">= 1</span><span 
class="zptmcm7m-x-x-120">.</span><span 
class="zptmcm7t-x-x-120">3</span></span></figcaption><!--tex4ht:label?: x1-29002r7 -->
                                                                                         
                                                                                         
</figure>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-29003r8"></a>
                                                                                         
                                                                                         
<!--l. 349--><p class="noindent" ><img 
src="images/windTunnel5.png" alt="PIC"  
width="400"  />
</p>
<figcaption class="caption" ><span class="id">Figure 8: </span><span  
class="content">Wind tunnel with confinement, <span 
class="zptmcm7m-x-x-120">𝜖 </span><span 
class="zptmcm7t-x-x-120">= 5</span><span 
class="zptmcm7m-x-x-120">.</span><span 
class="zptmcm7t-x-x-120">0</span></span></figcaption><!--tex4ht:label?: x1-29003r8 -->
                                                                                         
                                                                                         
</figure>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-29004r9"></a>
                                                                                         
                                                                                         
<!--l. 354--><p class="noindent" ><img 
src="images/windTunnel10.png" alt="PIC"  
width="400"  />
</p>
<figcaption class="caption" ><span class="id">Figure 9: </span><span  
class="content">Wind tunnel with confinement, <span 
class="zptmcm7m-x-x-120">𝜖 </span><span 
class="zptmcm7t-x-x-120">= 10</span><span 
class="zptmcm7m-x-x-120">.</span><span 
class="zptmcm7t-x-x-120">0</span></span></figcaption><!--tex4ht:label?: x1-29004r9 -->
                                                                                         
                                                                                         
</figure>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-29005r10"></a>
                                                                                         
                                                                                         
<!--l. 359--><p class="noindent" ><img 
src="images/paintBeforeConfinement.png" alt="PIC"  
width="400"  />
</p>
<figcaption class="caption" ><span class="id">Figure 10: </span><span  
class="content">Paint before vorticity confinement</span></figcaption><!--tex4ht:label?: x1-29005r10 -->
                                                                                         
                                                                                         
</figure>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-29006r11"></a>
                                                                                         
                                                                                         
<!--l. 364--><p class="noindent" ><img 
src="images/paintAfterConfinement.png" alt="PIC"  
width="400"  />
</p>
<figcaption class="caption" ><span class="id">Figure 11: </span><span  
class="content">Paint after vorticity confinement</span></figcaption><!--tex4ht:label?: x1-29006r11 -->
                                                                                         
                                                                                         
</figure>
<h4 class="subsectionHead"><span class="titlemark">3.2    </span> <a 
 id="x1-300003.2"></a>Heat and Buoyancy</h4>
<!--l. 370--><p class="noindent" >See below for images.
</p>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-30001r12"></a>
                                                                                         
                                                                                         
<!--l. 374--><p class="noindent" ><img 
src="images/Heat Map.png" alt="PIC"  
width="400"  />
</p>
<figcaption class="caption" ><span class="id">Figure 12: </span><span  
class="content">The heat map showing the heat produced by the ball</span></figcaption><!--tex4ht:label?: x1-30001r12 -->
                                                                                         
                                                                                         
</figure>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-30002r13"></a>
                                                                                         
                                                                                         
<!--l. 380--><p class="noindent" ><img 
src="images/Still Flame.png" alt="PIC"  
width="400"  />
</p>
<figcaption class="caption" ><span class="id">Figure 13: </span><span  
class="content">The heat with the fire shader applied</span></figcaption><!--tex4ht:label?: x1-30002r13 -->
                                                                                         
                                                                                         
</figure>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-30003r14"></a>
                                                                                         
                                                                                         
<!--l. 386--><p class="noindent" ><img 
src="images/Moving Flame.png" alt="PIC"  
width="400"  />
</p>
<figcaption class="caption" ><span class="id">Figure 14: </span><span  
class="content">The heat in the wind tunnel</span></figcaption><!--tex4ht:label?: x1-30003r14 -->
                                                                                         
                                                                                         
</figure>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-30004r15"></a>
                                                                                         
                                                                                         
<!--l. 392--><p class="noindent" ><img 
src="images/Smoke Rising.png" alt="PIC"  
width="400"  />
</p>
<figcaption class="caption" ><span class="id">Figure 15: </span><span  
class="content">The effects of buoyancy on the smoke causes it to rise</span></figcaption><!--tex4ht:label?: x1-30004r15 -->
                                                                                         
                                                                                         
</figure>
<h4 class="subsectionHead"><span class="titlemark">3.3    </span> <a 
 id="x1-310003.3"></a>Game Effects</h4>
<!--l. 397--><p class="noindent" >See below for images. </p><figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-31001r16"></a>
                                                                                         
                                                                                         
<!--l. 400--><p class="noindent" ><img 
src="images/boombeach.png" alt="PIC"  
width="400"  />
</p>
<figcaption class="caption" ><span class="id">Figure 16: </span><span  
class="content">BoomBeach with smoke and flare grenade</span></figcaption><!--tex4ht:label?: x1-31001r16 -->
                                                                                         
                                                                                         
</figure>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-31002r17"></a>
                                                                                         
                                                                                         
<!--l. 405--><p class="noindent" ><img 
src="images/boombeach_smoke_100.png" alt="PIC"  
width="400""  />
</p>
<figcaption class="caption" ><span class="id">Figure 17: </span><span  
class="content">BoomBeach with smoke with 60% transparency</span></figcaption><!--tex4ht:label?: x1-31002r17 -->
                                                                                         
                                                                                         
</figure>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-31003r18"></a>
                                                                                         
                                                                                         
<!--l. 410--><p class="noindent" ><img 
src="images/boombeach_smoke_150.png" alt="PIC"  
width="400""  />
</p>
<figcaption class="caption" ><span class="id">Figure 18: </span><span  
class="content">BoomBeach with smoke with 41% transparency</span></figcaption><!--tex4ht:label?: x1-31003r18 -->
                                                                                         
                                                                                         
</figure>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-31004r19"></a>
                                                                                         
                                                                                         
<!--l. 415--><p class="noindent" ><img 
src="images/boombeach_smoke_200.png" alt="PIC"  
width="400""  />
</p>
<figcaption class="caption" ><span class="id">Figure 19: </span><span  
class="content">BoomBeach with smoke 21% transparency</span></figcaption><!--tex4ht:label?: x1-31004r19 -->
                                                                                         
                                                                                         
</figure>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-31005r20"></a>
                                                                                         
                                                                                         
<!--l. 420--><p class="noindent" ><img 
src="images/boombeach_smoke_255.png" alt="PIC"  
width="400""  />
</p>
<figcaption class="caption" ><span class="id">Figure 20: </span><span  
class="content">BoomBeach with smoke 0% transparency</span></figcaption><!--tex4ht:label?: x1-31005r20 -->
                                                                                         
                                                                                         
</figure>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-31006r21"></a>
                                                                                         
                                                                                         
<!--l. 425--><p class="noindent" ><img 
src="images/boombeach_flare_100.png" alt="PIC"  
width="400""  />
</p>
<figcaption class="caption" ><span class="id">Figure 21: </span><span  
class="content">BoomBeach with flare 60% transparency</span></figcaption><!--tex4ht:label?: x1-31006r21 -->
                                                                                         
                                                                                         
</figure>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-31007r22"></a>
                                                                                         
                                                                                         
<!--l. 430--><p class="noindent" ><img 
src="images/boombeach_flare_150.png" alt="PIC"  
width="400""  />
</p>
<figcaption class="caption" ><span class="id">Figure 22: </span><span  
class="content">BoomBeach with flare 41% transparency</span></figcaption><!--tex4ht:label?: x1-31007r22 -->
                                                                                         
                                                                                         
</figure>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-31008r23"></a>
                                                                                         
                                                                                         
<!--l. 435--><p class="noindent" ><img 
src="images/boombeach_flare_200.png" alt="PIC"  
width="400""  />
</p>
<figcaption class="caption" ><span class="id">Figure 23: </span><span  
class="content">BoomBeach with flare 21% transparency</span></figcaption><!--tex4ht:label?: x1-31008r23 -->
                                                                                         
                                                                                         
</figure>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-31009r24"></a>
                                                                                         
                                                                                         
<!--l. 440--><p class="noindent" ><img 
src="images/boombeach_flare_255.png" alt="PIC"  
width="400""  />
</p>
<figcaption class="caption" ><span class="id">Figure 24: </span><span  
class="content">BoomBeach with flare 0% transparency</span></figcaption><!--tex4ht:label?: x1-31009r24 -->
                                                                                         
                                                                                         
</figure>
<h4 class="subsectionHead"><span class="titlemark">3.4    </span> <a 
 id="x1-320003.4"></a>Shaders</h4>
<!--l. 445--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">3.4.1    </span> <a 
 id="x1-330003.4.1"></a>Color Shader</h5>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-33001r25"></a>
                                                                                         
                                                                                         
<!--l. 448--><p class="noindent" ><img 
src="images/color_1.png" alt="PIC"  
width="400""  />
</p>
<figcaption class="caption" ><span class="id">Figure 25: </span><span  
class="content">Color Shader in the Wind Tunnel</span></figcaption><!--tex4ht:label?: x1-33001r25 -->
                                                                                         
                                                                                         
</figure>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-33002r26"></a>
                                                                                         
                                                                                         
<!--l. 453--><p class="noindent" ><img 
src="images/color_1.png" alt="PIC"  
width="400""  />
</p>
<figcaption class="caption" ><span class="id">Figure 26: </span><span  
class="content">Color Shader from the Ball</span></figcaption><!--tex4ht:label?: x1-33002r26 -->
                                                                                         
                                                                                         
</figure>
<h5 class="subsubsectionHead"><span class="titlemark">3.4.2    </span> <a 
 id="x1-340003.4.2"></a>Blocky Shader</h5>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-34001r27"></a>
                                                                                         
                                                                                         
<!--l. 460--><p class="noindent" ><img 
src="images/blocky_1.png" alt="PIC"  
width="400""  />
</p>
<figcaption class="caption" ><span class="id">Figure 27: </span><span  
class="content">Blocky Shader in the Wind Tunnel</span></figcaption><!--tex4ht:label?: x1-34001r27 -->
                                                                                         
                                                                                         
</figure>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-34002r28"></a>
                                                                                         
                                                                                         
<!--l. 465--><p class="noindent" ><img 
src="images/blocky_2.png" alt="PIC"  
width="400""  />
</p>
<figcaption class="caption" ><span class="id">Figure 28: </span><span  
class="content">Blocky Shader from the Ball</span></figcaption><!--tex4ht:label?: x1-34002r28 -->
                                                                                         
                                                                                         
</figure>
<h5 class="subsubsectionHead"><span class="titlemark">3.4.3    </span> <a 
 id="x1-350003.4.3"></a>Van Gogh Inspired Shader</h5>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-35001r29"></a>
                                                                                         
                                                                                         
<!--l. 472--><p class="noindent" ><img 
src="images/vangogh_1.png" alt="PIC"  
width="400""  />
</p>
<figcaption class="caption" ><span class="id">Figure 29: </span><span  
class="content">Van Gogh Shader in the Wind Tunnel</span></figcaption><!--tex4ht:label?: x1-35001r29 -->
                                                                                         
                                                                                         
</figure>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-35002r30"></a>
                                                                                         
                                                                                         
<!--l. 477--><p class="noindent" ><img 
src="images/vangogh_2.png" alt="PIC"  
width="400""  />
</p>
<figcaption class="caption" ><span class="id">Figure 30: </span><span  
class="content">Van Gogh Shader from the Ball</span></figcaption><!--tex4ht:label?: x1-35002r30 -->
                                                                                         
                                                                                         
</figure>
<h5 class="subsubsectionHead"><span class="titlemark">3.4.4    </span> <a 
 id="x1-360003.4.4"></a>Phong Model Inspired Shader</h5>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-36001r31"></a>
                                                                                         
                                                                                         
<!--l. 484--><p class="noindent" ><img 
src="images/phong_1.png" alt="PIC"  
width="400""  />
</p>
<figcaption class="caption" ><span class="id">Figure 31: </span><span  
class="content">Phong Shader in the Wind Tunnel</span></figcaption><!--tex4ht:label?: x1-36001r31 -->
                                                                                         
                                                                                         
</figure>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-36002r32"></a>
                                                                                         
                                                                                         
<!--l. 489--><p class="noindent" ><img 
src="images/phong_2.png" alt="PIC"  
width="400""  />
</p>
<figcaption class="caption" ><span class="id">Figure 32: </span><span  
class="content">Phong Shader from the Ball</span></figcaption><!--tex4ht:label?: x1-36002r32 -->
                                                                                         
                                                                                         
</figure>
<h5 class="subsubsectionHead"><span class="titlemark">3.4.5    </span> <a 
 id="x1-370003.4.5"></a>Heat Shader</h5>
<figure class="figure"> 

                                                                                         
                                                                                         
<a 
 id="x1-37001r33"></a>
                                                                                         
                                                                                         
<!--l. 496--><p class="noindent" ><img 
src="images/heat_1.png" alt="PIC"  
width="400""  />
</p>
<figcaption class="caption" ><span class="id">Figure 33: </span><span  
class="content">Heat Shader Demonstrating the Heat Dissipating off the Ball</span></figcaption><!--tex4ht:label?: x1-37001r33 -->
                                                                                         
                                                                                         
</figure>
<h3 class="sectionHead"><span class="titlemark">4    </span> <a 
 id="x1-380004"></a>Contributions</h3>
<!--l. 502--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.1    </span> <a 
 id="x1-390004.1"></a>Jade Kane</h4>
<!--l. 503--><p class="noindent" >Implemented anything to do with heat and buoyancy, as well as the fire shader. Helped with many of the
GUI buttons.
</p><!--l. 505--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.2    </span> <a 
 id="x1-400004.2"></a>Minjune Kim</h4>
<!--l. 506--><p class="noindent" >Implemented the smokes and the grenades that are used in game effects. It is able to change it’s
transparency with some changes in the backend code. Implemented the Boom Beach toggle
that would allow us to overlay the smoke grenades and flare grenades over a Boom Beach
base.
</p><!--l. 508--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.3    </span> <a 
 id="x1-410004.3"></a>Danny Tran</h4>
<!--l. 509--><p class="noindent" >Implemented almost all the shaders and worked with Minjune on implementing the smoke grenades and
flare grenades. Also set up the code for the write up and did the write up for the introduction and sections I
worked on.
</p><!--l. 511--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.4    </span> <a 
 id="x1-420004.4"></a>Victor Zhou</h4>
<!--l. 512--><p class="noindent" >Implemented confined vorticity for the fluid to simulate a more realistic and life-like effect, coded part of
the website’s additional GUI features, co-authored the writeups, and created the project website for the
writeups.
</p><!--l. 515--><p class="noindent" >
</p>
<h3 class="likesectionHead"><a 
 id="x1-430004.4"></a>References</h3>
                                                                                         
                                                                                         
<!--l. 515--><p class="noindent" >
      </p><div class="thebibliography">
      <p class="bibitem" ><span class="biblabel">
   [1]<span class="bibsp">   </span></span><a 
 id="Xbuo"></a><a 
href="https://en.wikipedia.org/wiki/Buoyancy" >"Buoyancy." Wikipedia.</a>
      </p>
      <p class="bibitem" ><span class="biblabel">
   [2]<span class="bibsp">   </span></span><a 
 id="XFSJ"></a><a 
href="https://web.stanford.edu/class/cs237d/smoke.pdf" >Fedkiw, Stam, Jensen. ”Visual Simulation of Smoke.”</a>
      </p>
      <p class="bibitem" ><span class="biblabel">
   [3]<span class="bibsp">   </span></span><a 
 id="XMM"></a><a 
href="https://matthias-research.github.io/pages/tenMinutePhysics/index.html" >Müller, Mattias. ”How to write an Eulerian Fluid Simulator with 200 lines of code.”
      December 2022</a>
      </p>
      <p class="bibitem" ><span class="biblabel">
   [4]<span class="bibsp">   </span></span><a 
 id="Xrad"></a><a 
href="https://courses.lumenlearning.com/suny-physics/chapter/14-7-radiation/#:~:text=The%20rate%20of%20heat%20transfer%20by%20emitted%20radiation%20is%20determined,its%20absolute%20temperature%20in%20kelvin" >OpenStax College. "College Physics". Jun 21, 2012</a>
</p>
      <p class="bibitem" ><span class="biblabel">
   [5]<span class="bibsp">   </span></span><a 
 id="XSRF"></a><a 
href="https://www.researchgate.net/publication/220183434_A_vortex_particle_method_for_smoke_water_and_explosions" >Selle, Rasmussen, Fedkiw. ”A vortex particle method for smoke, water and explosions.”
      July 2005.</a>
      </p>
       
</body> 
</html>
                                                                                         


